<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Make a GRanges object from a data.frame or DataFrame — makeGRangesFromDataFrame • GenomicRanges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Make a GRanges object from a data.frame or DataFrame — makeGRangesFromDataFrame"><meta property="og:description" content="makeGRangesFromDataFrame takes a data-frame-like object as
  input and tries to automatically find the columns that describe
  genomic ranges. It returns them as a GRanges object.
makeGRangesFromDataFrame is also the workhorse behind the
  coercion method from data.frame (or DataFrame) to
  GRanges."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GenomicRanges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.51.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/GenomicRangesIntroduction.html">An Introduction to the GenomicRanges Package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Bioconductor/GenomicRanges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Make a GRanges object from a data.frame or DataFrame</h1>
    
    <div class="hidden name"><code>makeGRangesFromDataFrame.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>makeGRangesFromDataFrame</code> takes a data-frame-like object as
  input and tries to automatically find the columns that describe
  genomic ranges. It returns them as a <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object.</p>
<p><code>makeGRangesFromDataFrame</code> is also the workhorse behind the
  coercion method from data.frame (or <a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a>) to
  <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>,</span>
<span>                         keep.extra.columns<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                         ignore.strand<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                         seqinfo<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                         seqnames.field<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqnames"</span>, <span class="st">"seqname"</span>,</span>
<span>                                          <span class="st">"chromosome"</span>, <span class="st">"chrom"</span>,</span>
<span>                                          <span class="st">"chr"</span>, <span class="st">"chromosome_name"</span>,</span>
<span>                                          <span class="st">"seqid"</span><span class="op">)</span>,</span>
<span>                         start.field<span class="op">=</span><span class="st">"start"</span>,</span>
<span>                         end.field<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"end"</span>, <span class="st">"stop"</span><span class="op">)</span>,</span>
<span>                         strand.field<span class="op">=</span><span class="st">"strand"</span>,</span>
<span>                         starts.in.df.are.0based<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                         na.rm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>A data.frame or <a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a> object. If not, then
    the function first tries to turn <code>df</code> into a data frame with
    <code>as.data.frame(df)</code>.</p></dd>

  <dt>keep.extra.columns</dt>
<dd><p><code>TRUE</code> or <code>FALSE</code> (the default).
    If <code>TRUE</code>, the columns in <code>df</code> that are not used to form
    the genomic ranges of the returned <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object are then
    returned as metadata columns on the object. Otherwise, they are ignored.
    If <code>df</code> has a <code>width</code> column, then it's always ignored.</p></dd>

  <dt>ignore.strand</dt>
<dd><p><code>TRUE</code> or <code>FALSE</code> (the default).
    If <code>TRUE</code>, then the strand of the returned <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object
    is set to <code>"*"</code>.</p></dd>

  <dt>seqinfo</dt>
<dd><p>Either <code>NULL</code>, or a <a href="https://rdrr.io/pkg/GenomeInfoDb/man/Seqinfo-class.html" class="external-link">Seqinfo</a> object,
    or a character vector of unique sequence names (a.k.a. <em>seqlevels</em>),
    or a named numeric vector of sequence lengths.
    When not <code>NULL</code>, <code>seqinfo</code> must be compatible with the genomic
    ranges in <code>df</code>, that is, it must have one entry for each unique
    sequence name represented in <code>df</code>. Note that it can have additional
    entries i.e. entries for seqlevels not represented in <code>df</code>.</p></dd>

  <dt>seqnames.field</dt>
<dd><p>A character vector of recognized names for the column in <code>df</code>
    that contains the chromosome name (a.k.a. sequence name) associated
    with each genomic range.
    Only the first name in <code>seqnames.field</code> that is found
    in <code>colnames(df)</code> is used.
    If no one is found, then an error is raised.</p></dd>

  <dt>start.field</dt>
<dd><p>A character vector of recognized names for the column in <code>df</code>
    that contains the start positions of the genomic ranges.
    Only the first name in <code>start.field</code> that is found
    in <code>colnames(df)</code> is used.
    If no one is found, then an error is raised.</p></dd>

  <dt>end.field</dt>
<dd><p>A character vector of recognized names for the column in <code>df</code>
    that contains the end positions of the genomic ranges.
    Only the first name in <code>start.field</code> that is found
    in <code>colnames(df)</code> is used.
    If no one is found, then an error is raised.</p></dd>

  <dt>strand.field</dt>
<dd><p>A character vector of recognized names for the column in <code>df</code>
    that contains the strand associated with each genomic range.
    Only the first name in <code>strand.field</code> that is found
    in <code>colnames(df)</code> is used.
    If no one is found or if <code>ignore.strand</code> is <code>TRUE</code>,
    then the strand of the returned <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object is
    set to <code>"*"</code>.</p></dd>

  <dt>starts.in.df.are.0based</dt>
<dd><p><code>TRUE</code> or <code>FALSE</code> (the default).
    If <code>TRUE</code>, then the start positions of the genomic ranges in
    <code>df</code> are considered to be <em>0-based</em> and are converted to
    <em>1-based</em> in the returned <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object.
    This feature is intended to make it more convenient to handle input
    that contains data obtained from resources using the "0-based
    start" convention. A notorious example of such resource is the UCSC
    Table Browser (<a href="http://genome.ucsc.edu/cgi-bin/hgTables" class="external-link">http://genome.ucsc.edu/cgi-bin/hgTables</a>).</p></dd>

  <dt>na.rm</dt>
<dd><p><code>TRUE</code> or <code>FALSE</code> (the default).
    If <code>TRUE</code>, rows in the <code>df</code> will be dropped when missing
    (<code>NA</code>) start or end range values are present.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object with one element per row in the input.</p>


<p>If the <code>seqinfo</code> argument was supplied, the returned object will
  have exactly the seqlevels specified in <code>seqinfo</code> and in the same
  order. Otherwise, the seqlevels are ordered according to the output of
  the <code><a href="https://rdrr.io/pkg/GenomeInfoDb/man/rankSeqlevels.html" class="external-link">rankSeqlevels</a></code> function (except if</p>
<p></p>
<p><code>df</code> contains the seqnames in the form of a factor-Rle, in which
  case the levels of the factor-Rle become the seqlevels of the returned
  object and with no re-ordering).</p>


<p>If <code>df</code> has non-automatic row names (i.e. <code>rownames(df)</code> is
  not <code>NULL</code> and is not <code>seq_len(nrow(df))</code>), then they will be
  used to set names on the returned <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Coercing data.frame or <a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a> <code>df</code> into
  a <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> object (with <code>as(df, "GRanges")</code>), or
  calling <code>GRanges(df)</code>, are both equivalent to calling
  <code>makeGRangesFromDataFrame(df, keep.extra.columns=TRUE)</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>H. Pagès, based on a proposal by Kasper Daniel Hansen</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p></p><ul><li><p><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a> objects.</p></li>
<li><p><a href="https://rdrr.io/pkg/GenomeInfoDb/man/Seqinfo-class.html" class="external-link">Seqinfo</a> objects and the
          <code><a href="https://rdrr.io/pkg/GenomeInfoDb/man/rankSeqlevels.html" class="external-link">rankSeqlevels</a></code> function in the
          <span class="pkg">GenomeInfoDb</span> package.</p></li>
<li><p>The <code><a href="GRangesList-class.html">makeGRangesListFromFeatureFragments</a></code> function
          for making a <a href="GRangesList-class.html">GRangesList</a> object from a list of fragmented
          features.</p></li>
<li><p>The <code><a href="https://rdrr.io/pkg/rtracklayer/man/UCSCTableQuery-class.html" class="external-link">getTable</a></code> function in the
          <span class="pkg">rtracklayer</span> package for an R interface to the UCSC
          Table Browser.</p></li>
<li><p><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a> objects in the <span class="pkg">S4Vectors</span> package.</p></li>
</ul></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## BASIC EXAMPLES</span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>chr<span class="op">=</span><span class="st">"chr1"</span>, start<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, end<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>,</span></span>
<span class="r-in"><span>                 strand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"-"</span>,<span class="st">"+"</span>,<span class="st">"*"</span>,<span class="st">"."</span><span class="op">)</span>, score<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chr start end strand score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 chr1    11  12      +     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 chr1    12  13      -     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 chr1    13  14      +     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 chr1    14  15      *     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 chr1    15  16      .     5</span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span><span class="op">)</span>  <span class="co"># strand value "." is replaced with "*"</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## NA in ranges</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">end</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chr start end strand score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 chr1    11  12      +     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 chr1    12  NA      -     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 chr1    13  14      +     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 chr1    14  15      *     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 chr1    NA  16      .     5</span>
<span class="r-in"><span><span class="co">#makeGRangesFromDataFrame(df)  # error!</span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># rows with NAs got dropped</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 3 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     13-14      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The strand column is optional:</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>chr<span class="op">=</span><span class="st">"chr1"</span>, start<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, end<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>, score<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, keep.extra.columns<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"GRanges"</span><span class="op">)</span>  <span class="co"># equivalent to the above</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">gr2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>        <span class="co"># equivalent to the above</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">gr2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, ignore.strand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, keep.extra.columns<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             ignore.strand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 1 metadata column:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand |     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      * |         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      * |         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      * |         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      * |         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      * |         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, seqinfo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 4 sequences from an unspecified genome; no seqlengths</span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, seqinfo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>chrM<span class="op">=</span><span class="cn">NA</span>, chr1<span class="op">=</span><span class="fl">500</span>, chrX<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 3 sequences from an unspecified genome</span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, seqinfo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/Seqinfo-class.html" class="external-link">Seqinfo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 4 sequences from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## ABOUT AUTOMATIC DETECTION OF THE seqnames/start/end/strand COLUMNS</span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Automatic detection of the seqnames/start/end/strand columns is</span></span></span>
<span class="r-in"><span><span class="co">## case insensitive:</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ChRoM<span class="op">=</span><span class="st">"chr1"</span>, StarT<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, stoP<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>,</span></span>
<span class="r-in"><span>                 STRAND<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"-"</span>,<span class="st">"+"</span>,<span class="st">"*"</span>,<span class="st">"."</span><span class="op">)</span>, score<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## It also ignores a common prefix between the start and end columns:</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>seqnames<span class="op">=</span><span class="st">"chr1"</span>, tx_start<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, tx_end<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>,</span></span>
<span class="r-in"><span>                 strand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="st">"-"</span>,<span class="st">"+"</span>,<span class="st">"*"</span>,<span class="st">"."</span><span class="op">)</span>, score<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr1     11-12      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr1     12-13      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr1     13-14      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr1     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr1     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The common prefix between the start and end columns is used to</span></span></span>
<span class="r-in"><span><span class="co">## disambiguate between more than one seqnames column:</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>chrom<span class="op">=</span><span class="st">"chr1"</span>, tx_start<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, tx_end<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>,</span></span>
<span class="r-in"><span>                 tx_chr<span class="op">=</span><span class="st">"chr2"</span>, score<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 5 ranges and 0 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]     chr2     11-12      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]     chr2     12-13      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chr2     13-14      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chr2     14-15      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]     chr2     15-16      *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## 0-BASED VS 1-BASED START POSITIONS</span></span></span>
<span class="r-in"><span><span class="co">## ---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">session</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/browserSession-methods.html" class="external-link">browserSession</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">genome</a></span><span class="op">(</span><span class="va">session</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"sacCer2"</span></span></span>
<span class="r-in"><span>  <span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/UCSCTableQuery-class.html" class="external-link">ucscTableQuery</a></span><span class="op">(</span><span class="va">session</span>, <span class="st">"Assembly"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/UCSCTableQuery-class.html" class="external-link">getTable</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## A common pitfall is to forget that the UCSC Table Browser uses the</span></span></span>
<span class="r-in"><span>  <span class="co">## "0-based start" convention:</span></span></span>
<span class="r-in"><span>  <span class="va">gr0</span> <span class="op">&lt;-</span> <span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, keep.extra.columns<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                      start.field<span class="op">=</span><span class="st">"chromStart"</span>,</span></span>
<span class="r-in"><span>                                      end.field<span class="op">=</span><span class="st">"chromEnd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## The start positions need to be converted into 1-based positions,</span></span></span>
<span class="r-in"><span>  <span class="co">## to adhere to the convention used in Bioconductor:</span></span></span>
<span class="r-in"><span>  <span class="va">gr1</span> <span class="op">&lt;-</span> <span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span><span class="va">df</span>, keep.extra.columns<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                      start.field<span class="op">=</span><span class="st">"chromStart"</span>,</span></span>
<span class="r-in"><span>                                      end.field<span class="op">=</span><span class="st">"chromEnd"</span>,</span></span>
<span class="r-in"><span>                                      starts.in.df.are.0based<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gr1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'track' parameter is deprecated now you go by the 'table' instead</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                 Use ucscTables(genome, track) to retrieve the list of tables for a track</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 6 ranges and 6 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       seqnames    ranges strand |       bin        ix        type        frag</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]    chrIV 1-1531919      + |         9         4           F   NC_001136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]  2micron    1-6318      + |       585        17           F   NC_001398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]     chrM   1-85779      + |       585         1           F   NC_001224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]     chrI  1-230208      + |        73         1           F   NC_001133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]    chrVI  1-270148      + |        73         6           F   NC_001138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6]   chrIII  1-316617      + |        73         3           F   NC_001135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       fragStart   fragEnd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]         0   1531919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]         0      6318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]         0     85779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]         0    230208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]         0    270148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6]         0    316617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 18 sequences from an unspecified genome; no seqlengths</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Aboyoun, Hervé Pagès, Michael Lawrence.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

